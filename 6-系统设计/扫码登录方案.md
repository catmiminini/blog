# 扫码登录

场景:
用户在 web 端访问网站,需要登录, 此时选择手机扫码登录, web 端显示出二维码;
用户使用对应的手机 app 扫码, 如果用户在手机 app 上已登录, 则 web 端显示登录成功, 跳转到登录成功页面, 否则等待二维码失效.

流程:
1. web浏览器 向 后端服务 请求二维码;
2. 后端服务 生成本次登录请求的uuid, 存储到redis中, 并将uuid转换成二维码返回给前端; (也可以前端收到uuid转成二维码)
3. web浏览器 得到二维码并展示, 向后端服务轮询登录状态;

4. 用户 使用 手机App 扫码, 得到一个验证信息和uuid
5. App 发现是登录请求后, 发送请求 将token以及uuid传给 后端服务
6. 后端服务收到后对吧验证信息以及uuid, 返回确认消息给手机, 等待用户二次确认; 更新扫码状态为已扫码

7. 此时web浏览器轮询到扫码状态为已扫码, 更新界面, 继续轮询

8. 用户二次确认后, 再次发送请求, 服务器更新登录状态

9. 此时web浏览器轮询到登录状态为已登录, 并得到userid



## 参考

- [扫码登陆原理简析](https://www.cnblogs.com/54chensongxia/p/12530268.html)
