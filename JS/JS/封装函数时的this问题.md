# 封装函数时的this问题
有时会封装一些延时调用函数，延时调用函数创建和调用时可能处在两个不同的上下文中，并且this指向不同，此时回调函数内使用的this就需要进行处理。

1. 回调函数内部可能绑定了this，也可能未绑定，使用动态this。
2. 我们无法修改回调函数的实现逻辑。
3. 函数创建时和调用时对应两个this。
4. 此封装过程分为三个角色：cb实现者，封装函数实现者，调用者。
5. 调用者可以说明希望使用两个this中的哪一个；封装者无法确定this指向，并且this指向完全由调用者和cb实现者控制；cb实现者可以决定最终的this指向。

结论：
1. 调用者在调用后得到封装函数，此时是创建时机，他可以决定是否绑定创建时的this。如果绑定，就应当尝试使用绑定的this, 绑定后的this在调用时机生效；否则就应当尝试使用调用时的this。
2. 封装者在封装时，使用apply方法绑定调用时机的this到cb上。
3. cb实现者可以决定是否使用this，以及决定以哪个对象作为最终的this。

进一步：
1. 关注封装者的封装过程，应该直接将函数调用时的this尝试绑定到cb上，也就是`cb.apply(this, arguments)`;