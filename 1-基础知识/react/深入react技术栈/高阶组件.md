# 高阶组件

高阶组件本质上是一个高阶函数, 通过层层嵌套, 实现对参数和逻辑的分层代理.

高阶函数主要有两种形式: 属性代理和反向继承

## 属性代理

> 下文中分别使用**封装组件**和**参数组件**对应 高阶组件的**返回值组件**和**参数组件**.

属性代理表现为在高阶组件中**使用**参数组件. 对参数组件的内部实现不做变更, 在其外部扩充数据和逻辑.

属性代理可以做什么:
1. 操作props: 属性代理后, props会先传递到封装组件, 此时操作props, 会影响最终传递给参数组件的props. 例如可以使用外部props创建新的props对象, 将原来的属性重命名, 新增属性, 删除属性, 再传递给参数组件.

2. 用其他元素包裹参数组件.

3. 通过ref访问到组件实例: 这要求参数组件必须是类组件(Component对象), 而不是函数组件.

4. 抽离state: 参数组件中需要用到的state, 通过高阶组件抽离到返回值组件的state中, 再通过props的方式传给参数组件;


## 反向继承

反向继承表现为封装组件**继承**参数组件, 能通过封装组件(子类)直接操作参数组件(父类)内部的实现, 在其内部影响数据和逻辑.

反向继承可以做什么:
1. 渲染劫持: 通过返回super.render(), 或修改super.render()的返回值, 实现渲染劫持.
2. State抽象和更改: 在子类中不定义state, 就可以通过this.state获取到父类的state, 可以通过这种方式在封装组件中直接操作参数组件的各种属性, 包括state.

> super.render() 返回值是一个jsx对象, 可以进行操作.

## 参考

1. [React 中的高阶组件及其应用场景](https://juejin.cn/post/6844903782355042312)

## todo

- 完全没有例子..
